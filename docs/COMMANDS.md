# Taskflow Commands Reference

Quick reference for all Taskflow CLI commands.

For detailed workflows and usage patterns, see the [User Guide](./USER-GUIDE.md).

---

## Initialization & Setup

### `taskflow init [project-name]`

Initialize Taskflow in the current directory.

```bash
taskflow init                  # Auto-detect project name
taskflow init my-project       # Specify project name
```

Creates: `taskflow.config.json`, `tasks/`, `.taskflow/ref/`, `.taskflow/logs/`

---

### `taskflow upgrade [options]`

Upgrade reference files to the latest templates.

```bash
taskflow upgrade               # Upgrade with prompts
taskflow upgrade --diff        # Show what will change
taskflow upgrade --force       # Force overwrite all files
```

---

## Configuration

### `taskflow configure ai [options]`

Configure AI/LLM integration.

```bash
# Quick setup (single provider)
taskflow configure ai --provider anthropic --model claude-3-5-sonnet-20241022

# Advanced setup (multiple models)
taskflow configure ai --addModel '{"claude-sonnet":{"provider":"anthropic","model":"claude-3-5-sonnet-20241022","apiKey":"${ANTHROPIC_API_KEY}"}}'
taskflow configure ai --setPlanning claude-sonnet
taskflow configure ai --setExecution gpt-4o-mini

# View configuration
taskflow configure ai --show

# Disable AI features
taskflow configure ai --disable
```

**Supported providers**: `anthropic`, `openai-compatible`, `ollama`

See [CONFIG.md](./CONFIG.md) for detailed configuration options.

---

## PRD & Task Generation

### `taskflow prd create <feature-name>`

Create a Product Requirements Document template using an interactive AI-powered session.

```bash
taskflow prd create user-authentication
```

**Workflow**:
1. Enter feature title
2. Provide detailed summary (multi-line support)
3. Answer clarifying questions generated by AI
4. Review generated PRD

Creates: `tasks/prds/YYYY-MM-DD-user-authentication.md`

---

### `taskflow prd detect`

Scan the current codebase to detect existing features and patterns.

```bash
taskflow prd detect
```

**Options**:
- `--path`: Specify root directory (default: current)
- `--ignore`: Glob patterns to ignore
- `--output`: Output format (json/markdown)

---

### `taskflow prd analyze <prd-file>`

Analyze a PRD against the existing codebase to find gaps and implementation status.

```bash
taskflow prd analyze tasks/prds/YYYY-MM-DD-user-authentication.md
```

**Features**:
- Matches PRD requirements to code patterns
- Identifies missing, partial, and implemented features
- Generates a gap analysis report with effort estimates

---

### `taskflow prd migrate`

Generate a migration plan between packages or frameworks.

```bash
taskflow prd migrate --from="express" --to="fastify"
```

**Options**:
- `--from`: Source package/framework
- `--to`: Target package/framework
- `--context`: Additional context for the migration

---

### `taskflow prd generate-arch <prd-file>`

Generate architecture documentation from a PRD.

```bash
taskflow prd generate-arch tasks/prds/YYYY-MM-DD-user-authentication.md
```

Creates: `.taskflow/ref/coding-standards.md`, `.taskflow/ref/ARCHITECTURE-RULES.md`

**Requires**: AI configuration

---

### `taskflow tasks generate <prd-file>`

Generate task breakdown from a PRD.

```bash
taskflow tasks generate tasks/prds/YYYY-MM-DD-user-authentication.md
```

Creates: `tasks/project-index.json`, feature/story/task JSON files

**Requires**: AI configuration

---

## Task Workflow

### `taskflow start <task-id>`

Start working on a task.

```bash
taskflow start 1.1.0
```

- Creates/switches to story branch
- Sets status to `setup`
- Shows task details and next steps

---

### `taskflow do`

Show instructions for the current task state.

```bash
taskflow do
```

Displays state-specific guidance and next steps.

---

### `taskflow check`

Advance to the next workflow state or run validations.

```bash
taskflow check
```

**State progression**:
- `setup` → `implementing`
- `implementing` → `verifying`
- `verifying` → `validating`
- `validating` → runs configured checks → `committing` (if passed)

---

### `taskflow commit "<message>"`

Commit changes and mark task complete.

```bash
taskflow commit "- Add login endpoint
- Implement JWT authentication
- Add input validation"
```

- Creates conventional commit
- Pushes to remote
- Marks task as completed
- Shows next available task

---

## Navigation & UI

### `taskflow ui [options]`

Start the Taskflow Dashboard server.

```bash
taskflow ui                    # Start server (foreground)
taskflow ui --stop             # Stop background server
taskflow ui --status           # Check server status
taskflow ui --port 5000        # Run on specific port
```

- **Foreground**: Default mode, blocks terminal, shows logs.
- **Background**: Use `taskflow ui > logs.txt &` or system tools.
- **Status**: Shows running PID and port.
- **Stop**: Gracefully shuts down the background process.

---

### `taskflow status [id]`

View project, feature, or story status.

```bash
taskflow status          # Project overview
taskflow status 1        # Feature F1 details
taskflow status 1.1      # Story S1.1 details
```

---

### `taskflow next`

Find the next available task.

```bash
taskflow next
```

Shows the next task that can be started based on dependencies.

---

## Recovery

### `taskflow resume [status]`

Resume an interrupted or blocked task.

```bash
taskflow resume                    # Resume to current state
taskflow resume implementing       # Resume to specific state
```

---

### `taskflow skip --reason "<reason>"`

Block the current task.

```bash
taskflow skip --reason "Waiting for API deployment"
```

Sets task to `blocked` status and suggests next available task.

---

## Retrospective

### `taskflow retro add`

Add an error pattern to the retrospective.

```bash
taskflow retro add       # Interactive prompts

# Or non-interactive
taskflow retro add --category type_error --pattern "Cannot find module" --solution "Use .js extensions" --criticality high
```

---

### `taskflow retro list [category]`

List error patterns.

```bash
taskflow retro list              # All patterns
taskflow retro list type_error   # Specific category
```

---

## Command Cheat Sheet

```
Initialization
├─ init [name]                 Initialize project
├─ upgrade [--diff|--force]    Upgrade reference files
└─ configure ai [options]      Configure AI integration

Planning
├─ prd create <name>           Create PRD template
├─ prd generate-arch <file>    Generate architecture docs
└─ tasks generate <file>       Generate task breakdown

Workflow (Main Loop)
├─ start <id>                  Start task
├─ do                          Show current instructions
├─ check                       Advance state or validate
└─ commit "<message>"          Commit and complete

Navigation
├─ status [id]                 View progress
├─ next                        Find next task
└─ ui [options]                Start dashboard

Recovery
├─ resume [status]             Resume interrupted task
└─ skip --reason "<reason>"    Block current task

Learning
├─ retro add                   Add error pattern
└─ retro list [category]       View patterns
```

---

## Task State Flow

```
not-started → setup → implementing → verifying → validating → committing → completed
                                                      ↓
                                                   blocked
```

- **setup**: Read requirements and context
- **implementing**: Write code
- **verifying**: Self-review
- **validating**: Run automated checks
- **committing**: Ready to commit
- **blocked**: External blocker

---

## Validation Commands

Configured in `taskflow.config.json`:

```json
{
  "validation": {
    "commands": {
      "format": "prettier --write .",
      "lint": "eslint .",
      "typeCheck": "tsc --noEmit",
      "test": "jest",
      "build": "npm run build"
    }
  }
}
```

Runs during `taskflow check` when in `validating` state.

---

## Environment Variables

```bash
# AI Provider API Keys
export ANTHROPIC_API_KEY=sk-ant-...
export OPENAI_API_KEY=sk-...
export AZURE_OPENAI_API_KEY=...
export GROQ_API_KEY=gsk-...
```

Use `${VAR_NAME}` in config to reference environment variables.

---

For detailed workflows and examples, see:
- [Getting Started Guide](./GETTING-STARTED.md)
- [User Guide](./USER-GUIDE.md)
- [Configuration Guide](./CONFIG.md)
